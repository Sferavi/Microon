<html>
<style>
.error {
  color:red;
}

body, html {
  height: 100%;
  margin: 0;
}

.main_container {
  height: 100vh;
  width: 100vw;
  margin: 0;

}
.shopping_list_container {
    width: 100%;
    height: 100%;
    border: 5px solid #F0640A;
    background-color: #303030;
    color: white;
    padding: 10px;
    margin: 0 auto;

}

.shopping_list_title{
    text-align: center;
    letter-spacing: 3px;
    font-family:Verdana, Geneva, Tahoma, sans-serif;
    font-size: 72px;
    font-weight: bold;
    color: white;
}

.shopping_list_priority_text {
    font-family: 'Times New Roman', Times, serif;
    font-size: 24px;
    font-weight: 200;
    color: white;
    padding-left: 20px;
    padding-top: 20px;
}

.shopping_list_priority_buttons {
    float: left;
}

.shopping_list_priority_text {
    text-align: right;
    font-family: Arial, Helvetica, sans-serif;
}

.add_to_shopping_list_container {
    width: 100%;
    height: 70%;
    border: 3px solid #F0640A;
    background-color: #303030;
    border-radius: 40px;
    color: white;
    margin-top: 80px;
    margin-left: 140px;
    overflow: hidden;
}

.add_container_title {
    text-align: center;
    padding-top: 30px;
    padding-bottom: 30px;
    border-bottom: 4px solid #F0640A;
    background-color: #F0640A;

}

.item_name_section {
    text-align: center; 
    font-family: Arial, Helvetica, sans-serif; 
    font-size: 20px;
    padding-top: 10px;
}

.brand_name_section {
    text-align: center; 
    font-family: Arial, Helvetica, sans-serif; 
    font-size: 20px;
    padding-top: 10px;
}

.quantity_section {
    text-align: center; 
    font-family: Arial, Helvetica, sans-serif; 
    font-size: 20px;
    padding-top: 10px;
}

.item_priority_section {
    text-align: center; 
    font-family: Arial, Helvetica, sans-serif; 
    font-size: 20px;
    padding-top: 10px;
}

.store_name_section {
    text-align: center; 
    font-family: Arial, Helvetica, sans-serif; 
    font-size: 20px;
    padding-top: 10px;
}

.add_item {
    text-align: center;
    padding-top: 20px;
}

.btn-light {
  background-color: #F0640A !important;
  color: white !important;
  font-family: Arial, Helvetica, sans-serif !important;
  border-color: #303030 !important;
}
.nesto {
    display: flex;
    flex-direction: row;
}

.shopping_table_container {
    width: 100%;
    margin-left: 200px;
    margin-top: 110px;
    margin-right: 140px;
}

.shopping_list_table_content {
    color: white;
}

.table_content {
  color: white;
}

.shopping_list {
  background-color: #424141;
}

.shopping_list thead {
  background-color: #F0640A;
}

::placeholder {
   text-align: center; 
}

</style>

<head>

<title>Microon - Shopping List</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.13.2/themes/base/jquery-ui.css">
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.13.1/css/jquery.dataTables.css">
<link href="../css/styles.css" rel="stylesheet" />
<link rel="stylesheet" href="../css/spapp.css">
<script src="https://kit.fontawesome.com/45bb7d0eec.js" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/css/toastr.css">

</head>

<body>

<div class="main_container">    
    <div class="shopping_list_container">
        <div class="shopping_list_button_and_title">
            <h1 class="shopping_list_title">Shopping List</h1>
        </div>
        <div class="col-12 nesto">
        <div class="col-3 add_to_shopping_list_container">
            <h3 class="add_container_title">ADD NEW ITEM</h3>
            <form id="add_items_form">
                <div class="mb-3 item_name_section">
                    <label for="item_name" class="form-label">Item Name</label>
                    <input type="text" name="item_name" class="form-control form-control-lg" id="item_name" placeholder="e.g. Toothpaste" style="width: 80%; margin-left: 50px;">
                </div>
                <div class="mb-3 brand_name_section">
                    <label for="brand_name" class="form-label">Brand Name</label>
                    <input type="text" name="brand_name" class="form-control form-control-lg" id="brand_name" placeholder="e.g. Colgate" style="width: 80%; margin-left: 50px;">
                </div>
                <h3 class="quantity_section">Quantity and Unit</h3>
                <div class="input-group mb-3">
                    <input type="text" id="quantity" name="quantity" class="form-control-lg" placeholder="e.g. 3" aria-label="Text input with dropdown button" style="width: 50%; margin-left: 50px;">
                    <label for="unit_select" class="form-label"></label>
                    <select type="text" id="unit_select" name="unit_select" class="form-select" style="margin-right: 60px; margin-left: 20px; margin-top: 3px; height: 45px;">
                      <option selected>Choose...</option>
                      <option value="piece/s">piece/s</option>
                      <option value="kg">kg</option>
                      <option value="g">g</option>
                      <option value="l">l</option>
                      <option value="pair">pair</option>
                    </select>
                </div>
                <div class="mb-3 item_priority_section">
                    <label for="priority" class="form-label">Item Buying Priority</label>
                    <select type="text" id="priority" name="priority" class="form-select" style="width: 80%; margin-left: 50px; height: 45px;">
                        <option selected style="text-align: center;">Choose item priority</option>
                        <option value="High Priority" style="text-align: center;">High Priority</option>
                        <option value="Medium Priority" style="text-align: center;">Medium Priority</option>
                        <option value="Low Priority" style="text-align: center;">Low Priority</option>
                    </select>
                </div>
                <div class="mb-3 store_name_section">
                    <label for="store_name" class="form-label">Prefered Store To Buy The Item</label>
                    <input type="text" name="store_name" class="form-control form-control-lg" id="store_name" placeholder="e.g. Bingo" style="width: 80%; margin-left: 50px;">
                </div>
                <div class="add_item">
                    <button type="submit" class="btn btn-light btn-lg" style="text-align:right;">Add Item</button>   
                </div>
            </form>
        </div>
        <div class="shopping_table_container">
            <div class="row">
              <div class="col-12">
                <div class="table-responsive">
                  <table id="shopping_list_table" class="table shopping_list">
                    <div class="shopping_list_priority_buttons">
                    <thead>
                      <tr class="shopping_list_table_content">
                        <th>Item Name</th>
                        <th>Brand Name</th>
                        <th>Quantity</th>
                        <th>Priority</th>
                        <th>Store</th>
                      </tr>
                    </thead>
                    <tbody id="table_content" class="table_content">
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
        </div>
    </div>
    </div>
</div>
</body>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.5/jquery.validate.min.js"></script>
<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.13.1/js/jquery.dataTables.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>

<script>

$(document).ready(function() {
    get_items();
});

function get_items() {
  $.get('../rest/shopping_list', function(data) {
    var dataSet = [];
    for (var i = 0; i < data.length; i++) {
      dataSet.push([
        data[i].item_name,
        data[i].brand_name,
        data[i].quantity,
        data[i].priority,
        data[i].store_name,
      ]);
    }

    $("#shopping_list_table").DataTable({
      data: dataSet,
      columns: [
        {title: "Item Name"},
        {title: "Brand Name"},
        {title: "Quantity"},
        {title: "Priority"},
        {title: "Store Name"}
      ],
      dom: 'Bfrtip',
      "pageLength": 10,
      "lengthMenu": [2, 5, 10, 25, 50, "All"]
    });
  })
}

//ADD SHOPPING ITEMS
$('#add_items_form').validate({
  submitHandler: function(form) {
    var shopping_item = {
      item_name: $('#add_items_form input[name="item_name"]').val(),
      brand_name: $('#add_items_form input[name="brand_name"]').val(),
      quantity: $('#add_items_form input[name="quantity"]').val() + " " +$('#add_items_form select[name="unit_select"]').val(),
      priority: $('#add_items_form select[name="priority"]').val(),
      store_name: $('#add_items_form input[name="store_name"]').val()
    }
    $.post( "../rest/shopping_item/", shopping_item ).done(function(data) {
      toastr.success('You have added a new item');
      $('#shopping_list_table').DataTable().clear().destroy();
      get_items();
    }).fail(function(error) {
      toastr.error(error.responseText);
    });
  }
});

</script>
</html>